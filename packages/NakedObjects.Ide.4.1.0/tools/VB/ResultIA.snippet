<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets xmlns="http://schemas.microsoft.com/VisualStudio/2005/CodeSnippet">
  <CodeSnippet Format="1.0.0">
    <Header>
      <SnippetTypes>
        <SnippetType>Expansion</SnippetType>
      </SnippetTypes>
      <Keywords />
      <Title>Result Interface Association</Title>
      <Author>Naked Objects Group</Author>
      <Description>Code to support an association defined by a 'Result' Interface (one that only has one implementation)</Description>
      <HelpUrl>www.nakedobjects.net</HelpUrl>
      <Shortcut>resultia</Shortcut>
    </Header>
    <Snippet>
      <References />
      <Imports />
      <Declarations>
        <Literal Editable="true">
          <ID>Name</ID>
          <ToolTip>The name for the property holding the associated object</ToolTip>
          <Default>PropertyName</Default>
          <Function>
          </Function>
        </Literal>
        <Literal Editable="true">
          <ID>Repository</ID>
          <ToolTip>Repository that can find objects of the required type</ToolTip>
          <Default>Repository</Default>
          <Function>
          </Function>
        </Literal>
        <Literal Editable="true">
          <ID>FindById</ID>
          <ToolTip>Repository method for findng object by its ID</ToolTip>
          <Default>FindById</Default>
          <Function>
          </Function>
        </Literal>
        <Literal Editable="true">
          <ID>Id</ID>
          <ToolTip>Property or function on the interface type that returns the integer Id value</ToolTip>
          <Default>Id</Default>
          <Function>
          </Function>
        </Literal>
        <Object Editable="true">
          <ID>InterfaceType</ID>
          <ToolTip>The Interface defining the type of object to be associated</ToolTip>
          <Default>IType</Default>
          <Function>
          </Function>
          <Type>
          </Type>
        </Object>
      </Declarations>
      <Code Language="vb" Kind="method decl" Delimiter="$"><![CDATA[#Region "$Name$ Property of type $InterfaceType$ ('Result' interface)"


    <Hidden()>
    Public Overridable Property $Name$Id() As Integer


    Private _$Name$ As $InterfaceType$

    <NotPersisted()>
    Public Property $Name$() As $InterfaceType$
        Get
            If _$Name$ Is Nothing AndAlso $Name$Id > 0 Then
                _$Name$ = $Repository$.$FindById$($Name$Id)
            End If
            Return _$Name$
        End Get
        Set(ByVal value As $InterfaceType$)
            _$Name$ = value
            If value Is Nothing Then
                $Name$Id = Nothing
            Else
                $Name$Id = value.$Id$
            End If
        End Set

    End Property
#End Region
]]></Code>
    </Snippet>
  </CodeSnippet>
</CodeSnippets>